# API Introduction

To support our **Cloud hosted** offering, the Worldcoin Developer Portal offers an API to perform verification of World ID signatures. These include the `/precheck`, `/verify`, `/jwks`, and `/graphql` endpoints. The base URL for these requests is:

```
https://developer.worldcoin.org
```

## Verification Flow

In a normal World ID verification, the user connects their World app to the embedded IDKit widget within your application. After they verify, the `nullifier_hash`, `merkle_root`, and zero-knowledge `proof`, among other details are received by IDKit. From that point it is up to the developer to perform checks that the user's details are correct and valid. To make this easier, we've implemented endpoints that use the Developer Portal as a backend.

A typical IDKit response will look like this:

```json
{
  "nullifier_hash": "0x2ae86d6d747702b3b2c81811cd2b39875e8fa6b780ee4a207bdc203a7860b535",
  "proof": "0x051df7bb69be13ca1f6406e39c02bf5c8ddf710bd91aba675bf70e28f188e1092b5659...",
  "merkle_root": "0x09c2cc6add86f7f38a8f5b1ce0046c7d28bd54588054f37f9904561453aaab51",
  "credential_type": "orb"
}
```

Using these details, you can verify the user can complete the action by examining the `proof`. The [`/verify`](/api-docs/reference#/verify) endpoint perform the proof-check, and store the user's nullifier in one request, like so:

```ts
const app_id = 'app_625f94b3aab731374dbb74ea90ea04c6'
const action = 'test_action'
const signal = 'verification_123'

const response = await fetch(
  `https://developer.worldcoin.org/api/v1/verify/${app_id}`,
  {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: {
      action,
      signal,
      ...idkitResult,
    },
  }
)
```

If the user has not completed the action before, you will get a 200 response with a timestamp of the verification. The response will be similar to this:

```json
{
  "success": true,
  "action": "test_action",
  "nullifier_hash": "0x2bf8406809dcefb1486dadc96c0a897db9bab002053054cf64272db512c6fbd8",
  "created_at": "2023-02-18T11:20:39.530041+00:00"
}
```

The `/verify` endpoint can only be run once per proof, so any additional calls to the API will fail. To retrieve information about past verifications, we provide a GraphQL endpoint. Here's a sample query to retrieve all the past nullifiers for a given action:

```ts
const response = await fetch('https://developer.worldcoin.org/api/v1/graphql', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    Authorization: 'Bearer key_51583f044g30fc0b64551e2dfb0472c0',
  },
  body: JSON.stringify({
    query: `query NullifierQuery($app_id: String = "", $action: String = "") {
      nullifier(where: {action: {action: {_eq: $action}, app_id: {_eq: $app_id}}}) {
        nullifier_hash
        created_at
      }
    }`,
    variables: {
      app_id: app_id,
      action: action,
    },
  }),
})
```

For more information about the data exposed by our `/graphql` endpoint, please reach out to the World ID team directly.

### Precheck Verification

Before a user verifies, you may want to call `/precheck` to ensure that they are eligible for the action you are presenting them:

```ts
const response = fetch(
  `https://developer.worldcoin.org/api/v1/precheck/${app_id}`,
  {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: {
      action,
      nullifier_hash,
      external_nullifier,
    },
  }
)
```

You will receive a response indicating their eligibility, along with metadata for the action they are performing, such as the application name and logo. More details can be found in the [API reference](/api-docs/reference#/precheck/{app_id}).
